<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CareFlow - Hospital Management System</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap"
        rel="stylesheet">
    <style>
        /* ============================================
           MEDIBOT CHATBOT WIDGET - PURE JS VERSION
           ============================================ */

        /* Base Styles & Font */
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            background-color: #f9fafb;
            /* A light grey background for the demo page */
        }

        .medibot-widget * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        /* Floating Action Button (FAB) */
        .medibot-fab {
            position: fixed;
            bottom: 24px;
            right: 24px;
            width: 56px;
            height: 56px;
            background: linear-gradient(135deg, #4f46e5, #7c3aed);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
            z-index: 10000;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            border: none;
        }

        .medibot-fab:hover {
            transform: scale(1.1);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3);
        }

        .medibot-fab svg {
            width: 28px;
            height: 28px;
            fill: white;
            transition: opacity 0.3s ease-in-out, transform 0.3s ease-in-out;
            position: absolute;
        }

        .medibot-fab .medibot-fab-icon-close {
            opacity: 0;
            transform: rotate(-90deg);
        }

        .medibot-fab.active .medibot-fab-icon-open {
            opacity: 0;
            transform: rotate(90deg);
        }

        .medibot-fab.active .medibot-fab-icon-close {
            opacity: 1;
            transform: rotate(0deg);
        }

        /* Chat Window */
        .medibot-window {
            position: fixed;
            bottom: 90px;
            right: 24px;
            width: 400px;
            max-width: calc(100vw - 32px);
            height: 600px;
            max-height: calc(100vh - 120px);
            background: white;
            border-radius: 16px;
            box-shadow: 0 12px 48px rgba(0, 0, 0, 0.25);
            display: flex;
            flex-direction: column;
            z-index: 9999;
            opacity: 0;
            transform: scale(0.9) translateY(20px);
            pointer-events: none;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            overflow: hidden;
        }

        .medibot-window.active {
            opacity: 1;
            transform: scale(1) translateY(0);
            pointer-events: all;
        }

        /* Header */
        .medibot-header {
            background: linear-gradient(135deg, #4f46e5, #7c3aed);
            padding: 20px;
            display: flex;
            align-items: center;
            gap: 12px;
            flex-shrink: 0;
        }

        .medibot-header-avatar {
            width: 40px;
            height: 40px;
            background: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
        }

        .medibot-header-info h3 {
            color: white;
            font-size: 16px;
            font-weight: 600;
        }

        .medibot-header-status {
            display: flex;
            align-items: center;
            gap: 6px;
            font-size: 12px;
            color: #ddd6fe;
        }

        .medibot-status-dot {
            width: 8px;
            height: 8px;
            background: #4ade80;
            border-radius: 50%;
            animation: medibot-pulse 2s infinite;
        }

        @keyframes medibot-pulse {

            0%,
            100% {
                opacity: 1;
            }

            50% {
                opacity: 0.6;
            }
        }

        /* Messages Area */
        .medibot-messages {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
            background: #f3f4f6;
        }

        .medibot-message {
            display: flex;
            gap: 10px;
            margin-bottom: 16px;
            align-items: flex-end;
            animation: medibot-fadeIn 0.4s ease-out;
        }

        @keyframes medibot-fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .medibot-message.user {
            flex-direction: row-reverse;
        }

        .medibot-message-avatar {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
            flex-shrink: 0;
        }

        .medibot-message.bot .medibot-message-avatar {
            background: linear-gradient(135deg, #4f46e5, #7c3aed);
            color: white;
        }

        .medibot-message.user .medibot-message-avatar {
            background: #e5e7eb;
            color: #4b5563;
        }

        .medibot-message-bubble {
            max-width: 75%;
            padding: 12px 16px;
            border-radius: 18px;
            font-size: 14px;
            line-height: 1.5;
            word-wrap: break-word;
        }

        .medibot-message.bot .medibot-message-bubble {
            background: white;
            color: #374151;
            border-bottom-left-radius: 4px;
            box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05);
        }

        .medibot-message.user .medibot-message-bubble {
            background: linear-gradient(135deg, #4f46e5, #7c3aed);
            color: white;
            border-bottom-right-radius: 4px;
        }

        /* Typing Indicator */
        .medibot-typing-bubble {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 4px;
            height: 100%;
        }

        .medibot-typing-dot {
            width: 8px;
            height: 8px;
            background: #9ca3af;
            border-radius: 50%;
            animation: medibot-typing 1.4s infinite ease-in-out;
        }

        .medibot-typing-dot:nth-child(2) {
            animation-delay: 0.2s;
        }

        .medibot-typing-dot:nth-child(3) {
            animation-delay: 0.4s;
        }

        @keyframes medibot-typing {

            0%,
            60%,
            100% {
                transform: translateY(0);
            }

            30% {
                transform: translateY(-6px);
            }
        }

        /* Warning Banner */
        .medibot-warning {
            background: #fef3c7;
            padding: 12px 16px;
            font-size: 11px;
            color: #92400e;
            display: flex;
            gap: 8px;
            align-items: flex-start;
            border-top: 1px solid #fde68a;
            flex-shrink: 0;
        }

        .medibot-warning svg {
            width: 14px;
            height: 14px;
            fill: #f59e0b;
            flex-shrink: 0;
            margin-top: 1px;
        }

        /* Input Area */
        .medibot-input-area {
            padding: 16px;
            background: white;
            border-top: 1px solid #e5e7eb;
            display: flex;
            gap: 8px;
            flex-shrink: 0;
        }

        .medibot-input {
            flex: 1;
            padding: 10px 16px;
            border: 1px solid #d1d5db;
            border-radius: 20px;
            font-size: 14px;
            outline: none;
            transition: border-color 0.2s, box-shadow 0.2s;
        }

        .medibot-input:focus {
            border-color: #4f46e5;
            box-shadow: 0 0 0 2px rgba(79, 70, 229, 0.2);
        }

        .medibot-send-btn {
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, #4f46e5, #7c3aed);
            border: none;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: transform 0.2s, opacity 0.2s;
            flex-shrink: 0;
        }

        .medibot-send-btn:hover:not(:disabled) {
            transform: scale(1.05);
        }

        .medibot-send-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .medibot-send-btn svg {
            width: 18px;
            height: 18px;
            fill: white;
        }

        /* Responsive */
        @media (max-width: 480px) {
            .medibot-window {
                width: 100%;
                max-width: 100%;
                height: 100%;
                max-height: 100%;
                right: 0;
                bottom: 0;
                border-radius: 0;
            }
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Poppins', sans-serif;
            background: linear-gradient(135deg, #e8f4f8 0%, #f5f9fc 100%);
            color: #2c3e50;
            overflow-x: hidden;
            min-height: 100vh;
        }

        /* Header Styles */
        header {
            background: #ffffff;
            padding: 1.5rem 2rem;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
            position: sticky;
            top: 0;
            z-index: 1000;
            animation: slideDown 0.6s ease-out;
            border-bottom: 2px solid #0288d1;
        }

        .header-content {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            align-items: center;
            justify-content: space-between;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .logo-section {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .logo {
            font-size: 1.8rem;
            color: #0288d1;
            font-weight: 700;
            letter-spacing: 0.5px;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .logo-icon {
            width: 45px;
            height: 45px;
            background: linear-gradient(135deg, #0288d1 0%, #0097a7 100%);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            box-shadow: 0 2px 8px rgba(2, 136, 209, 0.3);
        }

        .tagline {
            color: #546e7a;
            font-size: 0.95rem;
            font-weight: 400;
            margin-top: 0.25rem;
        }

        /* Hero Section */
        .hero {
            min-height: calc(100vh - 100px);
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 3rem 2rem;
            animation: fadeIn 0.8s ease-out;
        }

        .hero-content {
            text-align: center;
            max-width: 900px;
            background: #ffffff;
            padding: 3.5rem 3rem;
            border-radius: 16px;
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.08);
            animation: slideUp 0.8s ease-out;
        }

        .hero-title {
            font-size: 3rem;
            font-weight: 700;
            color: #0288d1;
            margin-bottom: 1rem;
            line-height: 1.3;
        }

        .hero-subtitle {
            font-size: 1.3rem;
            color: #546e7a;
            margin-bottom: 3rem;
            font-weight: 400;
        }

        .cta-buttons {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 1.5rem;
            margin-top: 3rem;
        }

        .cta-button {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 0.75rem;
            padding: 1.3rem 2rem;
            font-size: 1.05rem;
            font-weight: 600;
            text-decoration: none;
            border-radius: 10px;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            position: relative;
            overflow: hidden;
        }

        .cta-button::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: rgba(255, 255, 255, 0.2);
            transition: left 0.4s ease;
        }

        .cta-button:hover::before {
            left: 100%;
        }

        .cta-button span {
            position: relative;
            z-index: 1;
        }

        .doctor-btn {
            background: linear-gradient(135deg, #0288d1 0%, #0277bd 100%);
            color: white;
        }

        .doctor-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(2, 136, 209, 0.3);
        }

        .nurse-btn {
            background: linear-gradient(135deg, #d81b60 0%, #c2185b 100%);
            color: white;
        }

        .nurse-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(216, 27, 96, 0.3);
        }

        .patient-btn {
            background: linear-gradient(135deg, #00897b 0%, #00796b 100%);
            color: white;
        }

        .patient-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(0, 137, 123, 0.3);
        }

        .button-icon {
            font-size: 1.5rem;
        }

        /* Features Section */
        .features {
            padding: 5rem 2rem;
            max-width: 1200px;
            margin: 0 auto;
        }

        .section-title {
            text-align: center;
            font-size: 2.3rem;
            font-weight: 700;
            color: #0288d1;
            margin-bottom: 3rem;
        }

        .features-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 2rem;
            margin-top: 2rem;
        }

        .feature-card {
            background: #ffffff;
            padding: 2.5rem;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.06);
            transition: all 0.3s ease;
            animation: fadeInUp 0.6s ease-out backwards;
            border-left: 4px solid #0288d1;
        }

        .feature-card:nth-child(1) {
            animation-delay: 0.1s;
            border-left-color: #0288d1;
        }

        .feature-card:nth-child(2) {
            animation-delay: 0.2s;
            border-left-color: #d81b60;
        }

        .feature-card:nth-child(3) {
            animation-delay: 0.3s;
            border-left-color: #00897b;
        }

        .feature-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.12);
        }

        .feature-icon {
            font-size: 3rem;
            margin-bottom: 1.5rem;
            display: inline-block;
        }

        .feature-title {
            font-size: 1.4rem;
            font-weight: 600;
            color: #0288d1;
            margin-bottom: 1rem;
        }

        .feature-description {
            color: #546e7a;
            line-height: 1.7;
            font-size: 1rem;
        }

        /* Stats Section */
        .stats {
            background: linear-gradient(135deg, #0288d1 0%, #0097a7 100%);
            padding: 4rem 2rem;
            margin: 3rem 0;
        }

        .stats-grid {
            max-width: 1200px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 3rem;
            text-align: center;
        }

        .stat-item {
            color: white;
        }

        .stat-number {
            font-size: 3rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
        }

        .stat-label {
            font-size: 1.1rem;
            opacity: 0.9;
        }

        /* Footer */
        footer {
            background: #ffffff;
            color: #2c3e50;
            padding: 2.5rem 2rem;
            border-top: 2px solid #e0e0e0;
        }

        .footer-content {
            max-width: 1200px;
            margin: 0 auto;
            text-align: center;
        }

        .footer-links {
            display: flex;
            gap: 2.5rem;
            justify-content: center;
            margin-bottom: 1.5rem;
            flex-wrap: wrap;
        }

        .footer-link {
            color: #546e7a;
            text-decoration: none;
            transition: color 0.3s ease;
            font-size: 1rem;
            font-weight: 500;
        }

        .footer-link:hover {
            color: #0288d1;
        }

        .copyright {
            color: #78909c;
            font-size: 0.95rem;
            margin-top: 1rem;
        }

        /* Animations */
        @keyframes slideDown {
            from {
                transform: translateY(-100%);
                opacity: 0;
            }

            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
            }

            to {
                opacity: 1;
            }
        }

        @keyframes slideUp {
            from {
                transform: translateY(30px);
                opacity: 0;
            }

            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        @keyframes fadeInUp {
            from {
                transform: translateY(20px);
                opacity: 0;
            }

            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        /* Responsive Design */
        @media (max-width: 968px) {
            .cta-buttons {
                grid-template-columns: 1fr;
            }

            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (max-width: 768px) {
            .hero-title {
                font-size: 2.3rem;
            }

            .hero-subtitle {
                font-size: 1.1rem;
            }

            .hero-content {
                padding: 2.5rem 2rem;
            }

            .logo {
                font-size: 1.5rem;
            }

            .features-grid {
                grid-template-columns: 1fr;
            }

            .section-title {
                font-size: 2rem;
            }

            .stat-number {
                font-size: 2.5rem;
            }

            .stats-grid {
                grid-template-columns: 1fr;
                gap: 2rem;
            }
        }

        @media (max-width: 480px) {
            header {
                padding: 1rem;
            }

            .hero-title {
                font-size: 1.8rem;
            }

            .cta-button {
                padding: 1.1rem 1.5rem;
                font-size: 1rem;
            }

            .hero-content {
                padding: 2rem 1.5rem;
            }
        }
    </style>
</head>

<body>
    <!-- Header -->
    <header>
        <div class="header-content">
            <div class="logo-section">
                <div class="logo">
                    <div class="logo-icon">‚öïÔ∏è</div>
                    CareFlow
                </div>
            </div>
            <div class="tagline">Efficient Care, Seamless Flow</div>
        </div>
    </header>

    <!-- Hero Section -->
    <section class="hero">
        <div class="hero-content">
            <h1 class="hero-title">Welcome to CareFlow</h1>
            <p class="hero-subtitle">Your Smart Hospital Management System</p>

            <div class="cta-buttons">
                <a href="doctor.html" class="cta-button doctor-btn">
                    <span class="button-icon">ü©∫</span>
                    <span>As a Doctor</span>
                </a>
                <a href="nurse.html" class="cta-button nurse-btn">
                    <span class="button-icon">üë©‚Äç‚öïÔ∏è</span>
                    <span>As a Nurse</span>
                </a>
                <a href="patient.html" class="cta-button patient-btn">
                    <span class="button-icon">üè•</span>
                    <span>As a Patient</span>
                </a>

            </div>
        </div>
    </section>

    <!-- Stats Section -->
    <section class="stats">
        <div class="stats-grid">
            <div class="stat-item">
                <div class="stat-number">10k+</div>
                <div class="stat-label">Patients Served</div>
            </div>
            <div class="stat-item">
                <div class="stat-number">500+</div>
                <div class="stat-label">Medical Staff</div>
            </div>
            <div class="stat-item">
                <div class="stat-number">50+</div>
                <div class="stat-label">Departments</div>
            </div>
            <div class="stat-item">
                <div class="stat-number">24/7</div>
                <div class="stat-label">Support Available</div>
            </div>
        </div>
        <div class="demo-page">

            <!-- ======================================
                 MEDIBOT WIDGET - COPY FROM HERE
                 ====================================== -->
            <div class="medibot-widget">
                <!-- Floating Button -->
                <button class="medibot-fab" id="medibot-fab" aria-label="Toggle chat">
                    <svg class="medibot-fab-icon-open" viewBox="0 0 24 24">
                        <path
                            d="M20 2H4c-1.1 0-2 .9-2 2v18l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm0 14H6l-2 2V4h16v12z" />
                    </svg>
                    <svg class="medibot-fab-icon-close" viewBox="0 0 24 24">
                        <path
                            d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z" />
                    </svg>
                </button>

                <!-- Chat Window -->
                <div class="medibot-window" id="medibot-window">
                    <!-- Header -->
                    <div class="medibot-header">
                        <div class="medibot-header-avatar">ü©∫</div>
                        <div class="medibot-header-info">
                            <h3>MediBot Assistant</h3>
                            <div class="medibot-header-status">
                                <span class="medibot-status-dot"></span>
                                <span>Online</span>
                            </div>
                        </div>
                    </div>

                    <!-- Messages -->
                    <div class="medibot-messages" id="medibot-messages">
                        <!-- Initial bot message is now added dynamically via JS -->
                    </div>

                    <!-- Warning -->
                    <div class="medibot-warning">
                        <svg viewBox="0 0 24 24">
                            <path d="M1 21h22L12 2 1 21zm12-3h-2v-2h2v2zm0-4h-2v-4h2v4z" />
                        </svg>
                        <div><strong>Disclaimer:</strong> This AI provides informational guidance only. Always consult a
                            certified doctor for diagnosis.</div>
                    </div>

                    <!-- Input -->
                    <form class="medibot-input-area" id="medibot-form">
                        <input type="text" class="medibot-input" id="medibot-input"
                            placeholder="Type your medical question..." autocomplete="off" />
                        <button type="submit" class="medibot-send-btn" id="medibot-send">
                            <svg viewBox="0 0 24 24">
                                <path d="M2.01 21L23 12 2.01 3 2 10l15 2-15 2z" />
                            </svg>
                        </button>
                    </form>
                </div>
            </div>



            <!-- Features Section -->
            <section class="features">
                <h2 class="section-title">Why Choose CareFlow?</h2>
                <div class="features-grid">
                    <div class="feature-card">
                        <div class="feature-icon">üìã</div>
                        <h3 class="feature-title">Easy Appointments</h3>
                        <p class="feature-description">Schedule and manage appointments with just a few clicks.
                            Streamline your
                            healthcare journey with our intelligent booking system.</p>
                    </div>
                    <div class="feature-card">
                        <div class="feature-icon">üíä</div>
                        <h3 class="feature-title">Medical Records</h3>
                        <p class="feature-description">Access your complete medical history securely anytime, anywhere.
                            All your
                            health data in one encrypted, easy-to-navigate platform.</p>
                    </div>
                    <div class="feature-card">
                        <div class="feature-icon">üè•</div>
                        <h3 class="feature-title">24/7 Support</h3>
                        <p class="feature-description">Round-the-clock assistance for all your healthcare needs. Our
                            dedicated
                            team is always here to help you.</p>
                    </div>
                </div>
            </section>

            <!-- Footer -->
            <footer>
                <div class="footer-content">
                    <div class="footer-links">
                        <a href="#" class="footer-link">About</a>
                        <a href="#" class="footer-link">Contact</a>
                        <a href="#" class="footer-link">Privacy Policy</a>
                        <a href="#" class="footer-link">Terms of Service</a>
                    </div>
                    <div class="copyright">¬© 2025 CareFlow | All Rights Reserved</div>
                </div>
            </footer>

            <script>
                // Smooth scroll behavior
                document.querySelectorAll('a[href^="#"]').forEach(anchor => {
                    anchor.addEventListener('click', function (e) {
                        e.preventDefault();
                        const target = document.querySelector(this.getAttribute('href'));
                        if (target) {
                            target.scrollIntoView({
                                behavior: 'smooth',
                                block: 'start'
                            });
                        }
                    });
                });

                // Intersection observer for scroll animations
                const observerOptions = {
                    threshold: 0.1,
                    rootMargin: '0px 0px -50px 0px'
                };

                const observer = new IntersectionObserver((entries) => {
                    entries.forEach(entry => {
                        if (entry.isIntersecting) {
                            entry.target.style.opacity = '1';
                            entry.target.style.transform = 'translateY(0)';
                        }
                    });
                }, observerOptions);

                document.querySelectorAll('.feature-card').forEach(card => {
                    observer.observe(card);
                });

                // Counter animation for stats
                const animateCounter = (element, target) => {
                    let current = 0;
                    const increment = target / 50;
                    const timer = setInterval(() => {
                        current += increment;
                        if (current >= target) {
                            element.textContent = target + (element.textContent.includes('+') ? '+' : '');
                            clearInterval(timer);
                        } else {
                            element.textContent = Math.floor(current) + (element.textContent.includes('+') ? '+' : '');
                        }
                    }, 30);
                };

                const statsObserver = new IntersectionObserver((entries) => {
                    entries.forEach(entry => {
                        if (entry.isIntersecting) {
                            const statNumbers = entry.target.querySelectorAll('.stat-number');
                            statNumbers.forEach(stat => {
                                const text = stat.textContent;
                                const hasPlus = text.includes('+');
                                const number = parseInt(text.replace(/\D/g, ''));

                                if (text.includes('k')) {
                                    stat.textContent = '0k+';
                                    let current = 0;
                                    const timer = setInterval(() => {
                                        current += 0.2;
                                        if (current >= number) {
                                            stat.textContent = number + 'k+';
                                            clearInterval(timer);
                                        } else {
                                            stat.textContent = current.toFixed(1) + 'k+';
                                        }
                                    }, 30);
                                } else if (text.includes('/')) {
                                    stat.textContent = text;
                                } else {
                                    animateCounter(stat, number);
                                }
                            });
                            statsObserver.unobserve(entry.target);
                        }
                    });
                }, { threshold: 0.5 });

                const statsSection = document.querySelector('.stats');
                if (statsSection) {
                    statsObserver.observe(statsSection);
                }
                (function () {
                    'use strict';

                    // ==================== CONFIGURATION ====================

                    // üîë PASTE YOUR GEMINI API KEY HERE
                    const GEMINI_API_KEY = "YOUR_GEMINI_API_KEY_HERE";

                    const GEMINI_API_URL = `https://generativelanguage.googleapis.com/v1beta/models/gemini-pro:generateContent?key=${GEMINI_API_KEY}`;

                    // Medical-only system prompt
                    const SYSTEM_PROMPT = `You are MediBot, an AI medical assistant in a hospital system. 

STRICT RULES:
1. ONLY respond to medical/healthcare queries:
   - Symptoms, diseases, conditions
   - Treatments, medications, procedures
   - Appointments, hospital services
   - Doctor specializations, departments
   - Medical tests, diagnostics
   - Health and wellness advice

2. For NON-MEDICAL queries, respond: "I'm MediBot, a medical assistant. I can only help with health-related questions. Please ask about symptoms, treatments, appointments, or hospital services."

3. Always add disclaimer: "This is general information. Please consult a healthcare professional for personalized medical advice."

4. For urgent symptoms (chest pain, severe bleeding, difficulty breathing), immediately say: "This sounds urgent. Please seek immediate medical attention or call emergency services."

5. Be empathetic, clear, and use simple language.

Keep responses concise and helpful.`;

                    // ==================== DOM ELEMENTS ====================
                    const fab = document.getElementById('medibotFab');
                    const window = document.getElementById('medibotWindow');
                    const messages = document.getElementById('medibotMessages');
                    const input = document.getElementById('medibotInput');
                    const sendBtn = document.getElementById('medibotSend');

                    // ==================== STATE ====================
                    let isOpen = false;
                    let conversationHistory = [];

                    // ==================== USER SESSION (Optional) ====================
                    // Connect this to your hospital's authentication system
                    let currentUser = {
                        type: null, // 'patient' or 'doctor'
                        name: null,
                        id: null,
                        isLoggedIn: false
                    };

                    // Call this function after user login in your system
                    window.setMediBotUser = function (userType, userName, userId) {
                        currentUser = {
                            type: userType,
                            name: userName,
                            id: userId,
                            isLoggedIn: true
                        };

                        // Update greeting if chat is already open
                        if (isOpen && conversationHistory.length === 0) {
                            updateGreeting();
                        }
                    };

                    // Call this on logout
                    window.clearMediBotUser = function () {
                        currentUser = {
                            type: null,
                            name: null,
                            id: null,
                            isLoggedIn: false
                        };
                        conversationHistory = [];
                    };

                    function updateGreeting() {
                        const greeting = currentUser.isLoggedIn
                            ? `Hello ${currentUser.name}! I'm MediBot. How can I assist you with your health today?`
                            : `Hello! I'm MediBot, your AI medical assistant. How can I help you today?`;

                        const firstMsg = messages.querySelector('.medibot-message.bot .medibot-message-bubble');
                        if (firstMsg) {
                            firstMsg.innerHTML = greeting;
                        }
                    }

                    // ==================== EVENT LISTENERS ====================
                    fab.addEventListener('click', toggleChat);
                    sendBtn.addEventListener('click', sendMessage);
                    input.addEventListener('keypress', (e) => {
                        if (e.key === 'Enter' && !e.shiftKey) {
                            e.preventDefault();
                            sendMessage();
                        }
                    });

                    // ==================== FUNCTIONS ====================
                    function toggleChat() {
                        isOpen = !isOpen;
                        window.classList.toggle('active');
                        fab.classList.toggle('active');

                        if (isOpen) {
                            input.focus();
                            if (currentUser.isLoggedIn && conversationHistory.length === 0) {
                                updateGreeting();
                            }
                        }
                    }

                    function sendMessage() {
                        const text = input.value.trim();
                        if (!text) return;

                        // Validate API key
                        if (GEMINI_API_KEY === "YOUR_GEMINI_API_KEY_HERE") {
                            addBotMessage("‚ö†Ô∏è Error: Gemini API key not configured. Please add your API key in the code.");
                            return;
                        }

                        addUserMessage(text);
                        input.value = '';
                        sendBtn.disabled = true;

                        const typingMsg = showTyping();

                        callGeminiAPI(text)
                            .then(response => {
                                typingMsg.remove();
                                addBotMessage(response);
                            })
                            .catch(error => {
                                typingMsg.remove();
                                addBotMessage("I apologize, but I'm having trouble connecting. Please try again in a moment.");
                                console.error('MediBot Error:', error);
                            })
                            .finally(() => {
                                sendBtn.disabled = false;
                                input.focus();
                            });
                    }

                    async function callGeminiAPI(userMessage) {
                        const userContext = currentUser.isLoggedIn
                            ? `\n\nCONTEXT: Speaking with ${currentUser.type} "${currentUser.name}" (ID: ${currentUser.id}).`
                            : '';

                        const fullPrompt = SYSTEM_PROMPT + userContext + `\n\nUser: ${userMessage}\n\nAssistant:`;

                        const response = await fetch(GEMINI_API_URL, {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify({
                                contents: [{
                                    parts: [{ text: fullPrompt }]
                                }],
                                generationConfig: {
                                    temperature: 0.7,
                                    topK: 40,
                                    topP: 0.95,
                                    maxOutputTokens: 1024,
                                }
                            })
                        });

                        if (!response.ok) throw new Error(`API Error: ${response.status}`);

                        const data = await response.json();

                        if (data.candidates?.[0]?.content?.parts?.[0]?.text) {
                            return data.candidates[0].content.parts[0].text;
                        }
                        throw new Error('Invalid API response');
                    }

                    function addUserMessage(text) {
                        const div = document.createElement('div');
                        div.className = 'medibot-message user';
                        div.innerHTML = `
                    <div class="medibot-message-avatar">üë§</div>
                    <div class="medibot-message-bubble">${escapeHtml(text)}</div>
                `;
                        messages.appendChild(div);
                        scrollToBottom();
                        conversationHistory.push({ role: 'user', text });
                    }

                    function addBotMessage(text) {
                        const div = document.createElement('div');
                        div.className = 'medibot-message bot';
                        div.innerHTML = `
                    <div class="medibot-message-avatar">ü©∫</div>
                    <div class="medibot-message-bubble">${formatMessage(text)}</div>
                `;
                        messages.appendChild(div);
                        scrollToBottom();
                        conversationHistory.push({ role: 'bot', text });
                    }

                    function showTyping() {
                        const div = document.createElement('div');
                        div.className = 'medibot-message bot';
                        div.innerHTML = `
                    <div class="medibot-message-avatar">ü©∫</div>
                    <div class="medibot-message-bubble">
                        <div class="medibot-typing">
                            <span></span>
                            <span></span>
                            <span></span>
                        </div>
                    </div>
                `;
                        messages.appendChild(div);
                        scrollToBottom();
                        return div;
                    }

                    function formatMessage(text) {
                        text = escapeHtml(text);
                        text = text.replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>');
                        text = text.replace(/\n/g, '<br>');
                        return text;
                    }

                    function escapeHtml(text) {
                        const div = document.createElement('div');
                        div.textContent = text;
                        return div.innerHTML;
                    }

                    function scrollToBottom() {
                        messages.scrollTop = messages.scrollHeight;
                    }

                    // ==================== INITIALIZATION ====================
                    console.log('ü©∫ MediBot Widget Loaded');
                    console.log('üìù Add API key: GEMINI_API_KEY');
                    console.log('üîó Integration: setMediBotUser(type, name, id)');
                })();
            </script>
            <script type="module">
                import { GoogleGenAI } from "https://aistudiocdn.com/@google/genai@^1.28.0";

                // --- CONFIGURATION ---

                // PASTE YOUR GEMINI API KEY HERE
                const API_KEY = "AIzaSyCe_3sX0PA4dRh0r7s7UzWD-ys0YePULH4";

                const SYSTEM_PROMPT = `You are MediBot, an AI medical assistant in a hospital system. 
            
                    STRICT RULES:
                    1. ONLY respond to medical/healthcare queries:
                       - Symptoms, diseases, conditions
                       - Treatments, medications, procedures
                       - Appointments, hospital services
                       - Doctor specializations, departments
                       - Medical tests, diagnostics
                       - Health and wellness advice
            
                    2. For NON-MEDICAL queries, respond: "I'm MediBot, a medical assistant. I can only help with health-related questions. Please ask about symptoms, treatments, appointments, or hospital services."
            
                    3. Always add the disclaimer: "This is general information. Please consult a healthcare professional for personalized medical advice." at the end of every medical response.
            
                    4. For urgent symptoms (e.g., chest pain, severe bleeding, difficulty breathing, sudden weakness), immediately say: "This sounds urgent. Please seek immediate medical attention or call emergency services." and stop the conversation.
            
                    5. Be empathetic, clear, and use simple language. Avoid overly technical jargon.
            
                    6. Keep responses concise and helpful. Use formatting like bullet points (e.g., "* item") to improve readability.`;

                const INITIAL_GREETING = `Hello! I'm MediBot, your AI medical assistant. I can help you with:<br><br>
                                    &bull; Symptom analysis<br>
                                    &bull; Treatment information<br>
                                    &bull; Appointment guidance<br>
                                    &bull; Hospital services<br><br>
                                    How can I assist you today?`;

                // --- DOM ELEMENTS ---
                const fab = document.getElementById('medibot-fab');
                const windowEl = document.getElementById('medibot-window');
                const messagesEl = document.getElementById('medibot-messages');
                const formEl = document.getElementById('medibot-form');
                const inputEl = document.getElementById('medibot-input');
                const sendBtn = document.getElementById('medibot-send');

                // --- STATE ---
                let isOpen = false;
                let isLoading = false;
                let isInitialized = false;
                let chat = null;

                // --- UI FUNCTIONS ---
                function toggleChat() {
                    isOpen = !isOpen;
                    windowEl.classList.toggle('active');
                    fab.classList.toggle('active');
                    if (isOpen) {
                        inputEl.focus();
                    }
                }

                function scrollToBottom() {
                    messagesEl.scrollTop = messagesEl.scrollHeight;
                }

                function escapeHtml(text) {
                    const div = document.createElement('div');
                    div.textContent = text;
                    return div.innerHTML;
                }

                function formatMessageText(text) {
                    let safeText = escapeHtml(text);
                    // Bold: **text** -> <strong>text</strong>
                    safeText = safeText.replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>');
                    // Unordered lists: * item or - item -> &bull; item
                    safeText = safeText.replace(/^\s*[\*-]\s+(.*)/gm, '&bull; $1');
                    // Newlines -> <br>
                    safeText = safeText.replace(/\n/g, '<br />');
                    // Clean up extra breaks that might be created by the list conversion
                    safeText = safeText.replace(/<br \/>&bull;/g, '&bull;');
                    return safeText;
                }

                function addMessage(text, role, isFormatted = false) {
                    const messageDiv = document.createElement('div');
                    messageDiv.className = `medibot-message ${role}`;

                    const avatar = role === 'bot' ? 'ü©∫' : 'üë§';
                    const messageContent = isFormatted ? text : formatMessageText(text);

                    messageDiv.innerHTML = `
                            <div class="medibot-message-avatar">${avatar}</div>
                            <div class="medibot-message-bubble">${messageContent}</div>`;

                    messagesEl.appendChild(messageDiv);
                    scrollToBottom();
                }

                function showTypingIndicator() {
                    const typingDiv = document.createElement('div');
                    typingDiv.id = 'medibot-typing-indicator';
                    typingDiv.className = 'medibot-message bot';
                    typingDiv.innerHTML = `
                            <div class="medibot-message-avatar">ü©∫</div>
                            <div class="medibot-message-bubble">
                                <div class="medibot-typing-bubble">
                                    <span class="medibot-typing-dot"></span>
                                    <span class="medibot-typing-dot"></span>
                                    <span class="medibot-typing-dot"></span>
                                </div>
                            </div>`;
                    messagesEl.appendChild(typingDiv);
                    scrollToBottom();
                }

                function removeTypingIndicator() {
                    const indicator = document.getElementById('medibot-typing-indicator');
                    if (indicator) indicator.remove();
                }

                function setLoadingState(loading) {
                    isLoading = loading;
                    inputEl.disabled = loading;
                    sendBtn.disabled = loading;
                    inputEl.placeholder = loading ? "MediBot is thinking..." : "Type your medical question...";
                }

                // --- API & INITIALIZATION ---
                async function initializeApp() {
                    if (!API_KEY || API_KEY === "YOUR_API_KEY_HERE") {
                        console.error("MediBot Error: API_KEY is not set.");
                        addMessage("‚ö†Ô∏è I'm currently unavailable due to a configuration issue. Please add a valid API key.", 'bot');
                        setLoadingState(true);
                        inputEl.placeholder = "Chat unavailable";
                        return;
                    }

                    try {
                        const ai = new GoogleGenAI({ apiKey: API_KEY });
                        chat = ai.chats.create({
                            model: 'gemini-2.5-flash',
                            config: { systemInstruction: SYSTEM_PROMPT, temperature: 0.7 }
                        });
                        isInitialized = true;
                        console.log("MediBot is initialized and ready.");
                        addMessage(INITIAL_GREETING, 'bot', true);
                    } catch (error) {
                        console.error("MediBot Initialization Error:", error);
                        addMessage("‚ö†Ô∏è I'm having trouble starting up. Please check the API key and refresh the page.", 'bot');
                        setLoadingState(true);
                        inputEl.placeholder = "Initialization failed";
                    }
                }

                async function getBotResponse(userMessage) {
                    if (!isInitialized || !chat) {
                        return "I'm not ready yet. Please wait a moment or refresh the page.";
                    }
                    try {
                        const result = await chat.sendMessage({ message: userMessage });
                        return result.text;
                    } catch (error) {
                        console.error('Gemini API Error:', error);
                        return "I apologize, but I'm having trouble connecting. Please try again in a moment.";
                    }
                }

                // --- EVENT HANDLERS ---
                async function handleFormSubmit(e) {
                    e.preventDefault();
                    const userText = inputEl.value.trim();
                    if (!userText || isLoading || !isInitialized) return;

                    addMessage(userText, 'user');
                    inputEl.value = '';
                    setLoadingState(true);
                    showTypingIndicator();

                    const botResponse = await getBotResponse(userText);

                    removeTypingIndicator();
                    addMessage(botResponse, 'bot');
                    setLoadingState(false);
                    inputEl.focus();
                }

                // --- STARTUP ---
                fab.addEventListener('click', toggleChat);
                formEl.addEventListener('submit', handleFormSubmit);
                initializeApp();

            </script>
</body>

</html>